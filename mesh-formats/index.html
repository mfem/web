<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="/img/favicon.ico">
        <meta name="keywords" content="Finite Element Library,Finite Element Code,Finite Element Method Library,Finite Element Method Code,Finite Element C++,Finite Element Method C++,Finite Element Library C++,Finite Element Code C++,FEM Code,FEM Library,FEM C++">
        <meta name="google-site-verification" content="45K56TawSdzbgy-uDtfJdYwp7zaVdL3fIAGYt869wwU" />
<!--	<title></title>  -->
        <title>MFEM - Finite Element Discretization Library</title>

        <link href="../css/bootstrap-mfem.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../css/highlight.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="http://mfem.org">MFEM</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
            
            
            
                <li >
                    <!-- Replace "nav_item.url|url" with "nav_item.url" for older mkdocs (before 1.0) -->
                    <a href="../features/">Features</a>
                </li>
            
            
            
            
            
                <li >
                    <!-- Replace "nav_item.url|url" with "nav_item.url" for older mkdocs (before 1.0) -->
                    <a href="../examples/">Examples</a>
                </li>
            
            
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                    
                        
                            <li >
                                 <a href="../building/">Building MFEM</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../serial-tutorial/">Serial Tutorial</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../parallel-tutorial/">Parallel Tutorial</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../fem/">Finite Elements</a>
                            </li>
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            <li >
                                 <a href="../electromagnetics/">Electromagnetics</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../meshing/">Meshing</a>
                            </li>
                        
                    
                        
                    
                        
                    
                        
                            <li >
                                 <a href="../performance/">Performance</a>
                            </li>
                        
                    
                        
                    
                        
                    
                        
                            <li >
                                 <a href="../tools/">Tools</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../toys/">Toys</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../publications/">Publications</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../about/">About</a>
                            </li>
                        
                    
                    </ul>
                </li>
            
            
            
            
            
                <li >
                    <!-- Replace "nav_item.url|url" with "nav_item.url" for older mkdocs (before 1.0) -->
                    <a href="../gallery/">Gallery</a>
                </li>
            
            
            
            
            
                <li >
                    <!-- Replace "nav_item.url|url" with "nav_item.url" for older mkdocs (before 1.0) -->
                    <a href="../download/">Download</a>
                </li>
            
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                
                <li>
                    <a href="https://github.com/mfem/mfem/">
                        
                            <i class="fa fa-github-square"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
            <div class="col-md-3 visible-xs visible-sm"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#mesh-formats">Mesh Formats</a></li>
        
            <li><a href="#mfem-mesh-v10">MFEM mesh v1.0</a></li>
        
            <li><a href="#mfem-mesh-v11">MFEM mesh v1.1</a></li>
        
            <li><a href="#nurbs-meshes">NURBS meshes</a></li>
        
            <li><a href="#curvilinear-vtk-meshes">Curvilinear VTK meshes</a></li>
        
    
    </ul>
</div></div> <!-- toc on top on mobile -->
            <div class="col-md-9" role="main">

<h1 id="mesh-formats">Mesh Formats</h1>
<h2 id="mfem-mesh-v10">MFEM mesh v1.0</h2>
<p>This is the default format in GLVis. It can be used to describe simple (triangular, quadrilateral, tetrahedral and hexahedral meshes with straight edges) or complicated (curvilinear and more general) meshes.</p>
<h3 id="straight-meshes">Straight meshes</h3>
<p>In the simple case of a mesh with straight edges the format looks as follows</p>
<pre><code class="sh">MFEM mesh v1.0

# Space dimension: 2 or 3
dimension
&lt;dimension&gt;

# Mesh elements, e.g. tetrahedrons (4)
elements
&lt;number of elements&gt;
&lt;element attribute&gt; &lt;geometry type&gt; &lt;vertex index 1&gt; ... &lt;vertex index m&gt;
...

# Mesh faces/edges on the boundary, e.g. triangles (2)
boundary
&lt;number of boundary elements&gt;
&lt;boundary element attribute&gt; &lt;geometry type&gt; &lt;vertex index 1&gt; ... &lt;vertex index m&gt;
...

# Vertex coordinates
vertices
&lt;number of vertices&gt;
&lt;vdim&gt;
&lt;coordinate 1&gt; ... &lt;coordinate &lt;vdim&gt;&gt;
...
</code></pre>

<p>Lines starting with "#" denote comments. The supported geometry types are:</p>
<ul>
<li>POINT       = 0</li>
<li>SEGMENT     = 1</li>
<li>TRIANGLE    = 2</li>
<li>SQUARE      = 3</li>
<li>TETRAHEDRON = 4</li>
<li>CUBE        = 5</li>
<li>PRISM       = 6</li>
</ul>
<p>see the comments in <a href="https://github.com/mfem/mfem/blob/master/fem/geom.hpp">this source file</a> for more details.</p>
<p>For example, the <a href="https://github.com/mfem/mfem/blob/master/data/beam-quad.mesh">beam-quad.mesh</a> file from the data directory looks like this:</p>
<pre><code class="sh">MFEM mesh v1.0

dimension
2

elements
8
1 3 0 1 10 9
1 3 1 2 11 10
1 3 2 3 12 11
1 3 3 4 13 12
2 3 4 5 14 13
2 3 5 6 15 14
2 3 6 7 16 15
2 3 7 8 17 16

boundary
18
3 1 1 0
3 1 2 1
3 1 3 2
3 1 4 3
3 1 5 4
3 1 6 5
3 1 7 6
3 1 8 7
3 1 9 10
3 1 10 11
3 1 11 12
3 1 12 13
3 1 13 14
3 1 14 15
3 1 15 16
3 1 16 17
1 1 0 9
2 1 17 8

vertices
18
2
0 0
1 0
2 0
3 0
4 0
5 0
6 0
7 0
8 0
0 1
1 1
2 1
3 1
4 1
5 1
6 1
7 1
8 1
</code></pre>

<p>which corresponds to the mesh</p>
<p><img alt="" src="../img/formats/beam-quad.png" /></p>
<p>visualized with</p>
<pre><code class="sh">glvis -m beam-quad.mesh -k &quot;Ame****&quot;
</code></pre>

<h3 id="curvilinear-and-more-general-meshes">Curvilinear and more general meshes</h3>
<p>The MFEM mesh v1.0 format also support the general description of meshes based on a vector finite element grid function with degrees of freedom in the "nodes" of the mesh. This general format is described briefly below, and in more details on the <a href="../mesh-format-v1.x/">General Mesh Format page</a>.</p>
<pre><code class="sh">MFEM mesh v1.0

# Space dimension: 2 or 3
dimension
&lt;dimension&gt;

# Mesh elements, e.g. tetrahedrons (4)
elements
&lt;number of elements&gt;
&lt;element attribute&gt; &lt;geometry type&gt; &lt;vertex index 1&gt; ... &lt;vertex index m&gt;
...

# Mesh faces/edges on the boundary, e.g. triangles (2)
boundary
&lt;number of boundary elements&gt;
&lt;boundary element attribute&gt; &lt;geometry type&gt; &lt;vertex index 1&gt; ... &lt;vertex index m&gt;
...

# Number of vertices (no coordinates)
vertices
&lt;number of vertices&gt;

# Mesh nodes as degrees of freedom of a finite element grid function
nodes
FiniteElementSpace
FiniteElementCollection: &lt;finite element collection&gt;
VDim: &lt;dimension&gt;
Ordering: 0
&lt;x-coordinate degrees of freedom&gt;
...
&lt;y-coordinate degrees of freedom&gt;
...
&lt;z-coordinate degrees of freedom&gt;
...
</code></pre>

<p>Some possible <a href="https://github.com/mfem/mfem/blob/master/fem/fe_coll.hpp">finite element collection</a> choices are: <code>Linear</code>, <code>Quadratic</code> and <code>Cubic</code> corresponding to curvilinear P1/Q1, P2/Q2 and P3/Q3 meshes. The algorithm for the numbering of the degrees of freedom can be found in <a href="https://github.com/mfem/mfem/blob/master/fem/fespace.cpp#L739">MFEM's source code</a>.</p>
<p>For example, the <a href="https://github.com/mfem/mfem/blob/master/data/escher-p3.mesh">escher-p3.mesh</a> from MFEM's <a href="https://github.com/mfem/mfem/blob/master/data">data directory</a> describes a tetrahedral mesh with nodes given by a P3 vector Lagrangian finite element function. Visualizing this mesh with</p>
<pre><code class="sh">glvis -m escher-p3.mesh -k &quot;Aaaoooooooooo**************tt&quot;
</code></pre>

<p>we get:</p>
<p><img alt="" src="../img/formats/escher-p3.png" /></p>
<p>Topologically periodic meshes can also be described in this format, see for example the <a href="https://github.com/mfem/mfem/blob/master/data/periodic-segment.mesh">periodic-segment</a>, <a href="https://github.com/mfem/mfem/blob/master/data/periodic-square.mesh">periodic-square</a>, and <a href="https://github.com/mfem/mfem/blob/master/data/periodic-cube.mesh">periodic-cube</a> meshes in the data directory, as well as <a href="../examples/?advection">Example 9</a>.</p>
<h2 id="mfem-mesh-v11">MFEM mesh v1.1</h2>
<p>This format adds support for non-conforming (AMR) meshes. The sections
<code>dimension</code>, <code>elements</code>, and <code>boundary</code> are the same as in MFEM mesh v1.0 and
are followed by two new (optional) sections, <code>vertex_parents</code> and
<code>coarse_elements</code>:</p>
<pre><code class="sh"># Vertex hierarchy
vertex_parents
&lt;number of relations&gt;
&lt;vertex index&gt; &lt;parent 1 index&gt; &lt;parent 2 index&gt;
...

# Element hierarchy
coarse_elements
&lt;number of coarse elements&gt;
&lt;refinement type&gt; &lt;child index 1&gt; ... &lt;child index n&gt;
...
</code></pre>

<p>These are followed by the standard sections <code>vertices</code> and <code>nodes</code> of the format
MFEM mesh v1.0.</p>
<p>The new section <code>vertex_parents</code> identifies all vertices (by their zero-based
index) that have been created as new mid-edge vertices by adaptive refinement
of elements. Each such vertex has exactly two "parents" identified again by two
zero-based indices. This information is needed to construct constraining
relations in a mesh with hanging nodes. The order the vertex-parent relations
are stated in the file is not significant.</p>
<p>The second optional section <code>coarse_elements</code> describes the element refinement
hierarchy. While the standard section <code>elements</code> lists all leaf elements of the
refinement tree, this section describes all elements that have been refined and
are no longer active. Each line describes one such virtual element, its
refinement type and up to 8 children. Child indices between 0 and <em>N-1</em> refer
to the <em>N</em> active elements in the <code>elements</code> section. A coarse element has an
implied index starting with <em>N</em>. A coarse element can refer to another coarse
element of <em>index &gt;= N</em>, but only after such child has been defined in the
<code>coarse_elements</code> section. The hierarchy is thus represented from the bottom
up. The refinement types are: 1=X, 2=Y, 4=Z, 3=XY, 5=XZ, 6=YZ, 7=XYZ, where X,
Y, Z refer to one or more splits in the respective axes of the element
reference domain. If the entire section is missing, MFEM will not be able to
derefine the mesh.</p>
<p><img alt="" src="../img/fichera-amr.png" /></p>
<p>The files
<a href="https://github.com/mfem/mfem/blob/master/data/amr-quad.mesh">amr-quad.mesh</a>,
<a href="https://github.com/mfem/mfem/blob/master/data/amr-hex.mesh">amr-hex.mesh</a> and
<a href="https://github.com/mfem/mfem/blob/master/data/fichera-amr.mesh">fichera-amr.mesh</a>
(above) in the <code>data</code> directory are examples of AMR meshes.</p>
<h2 id="nurbs-meshes">NURBS meshes</h2>
<p>MFEM provides full support for meshes and discretization spaces based on Non-uniform Rational B-Splines (NURBS). These are treated similarly to general <a href="#curvilinear-and-more-general-meshes">curvilinear meshes</a> where the NURBS nodes are specified as a grid function at the end of the mesh file.</p>
<p>For example, here is a simple quadratic NURBS mesh for a square domain with a (perfectly) circular hole in the middle. (The exact representation of conical sections is a major advantage of the NURBS approach over high-order finite elements.)</p>
<pre><code class="sh">MFEM NURBS mesh v1.0

#
# MFEM Geometry Types (see mesh/geom.hpp):
#
# SEGMENT     = 1
# SQUARE      = 3
# CUBE        = 5
#

dimension
2

elements
4
1 3 0 1 5 4
1 3 1 2 6 5
1 3 2 3 7 6
1 3 3 0 4 7

boundary
8
1 1 0 1
1 1 1 2
1 1 2 3
1 1 3 0
1 1 5 4
1 1 6 5
1 1 7 6
1 1 4 7

edges
12
0 0 1
0 4 5
1 1 2
1 5 6
2 2 3
2 6 7
3 3 0
3 7 4
4 0 4
4 1 5
4 2 6
4 3 7

vertices
8

knotvectors
5
2  3 0 0 0 1 1 1
2  3 0 0 0 1 1 1
2  3 0 0 0 1 1 1
2  3 0 0 0 1 1 1
2  3 0 0 0 1 1 1

weights
1
1
1
1
1
1
1
1
1
0.707106781
1
0.707106781
1
0.707106781
1
0.707106781
1
1
1
1
0.853553391
0.853553391
0.853553391
0.853553391

FiniteElementSpace
FiniteElementCollection: NURBS2
VDim: 2
Ordering: 1

0 0
1 0
1 1
0 1
0.358578644 0.358578644
0.641421356 0.358578644
0.641421356 0.641421356
0.358578644 0.641421356
0.5 0
0.5 0.217157288
1 0.5
0.782842712 0.5
0.5 1
0.5 0.782842712
0 0.5
0.217157288 0.5
0.15 0.15
0.85 0.15
0.85 0.85
0.15 0.85
0.5  0.108578644
0.891421356 0.5
0.5 0.891421356
0.108578644 0.5
</code></pre>

<p>This above file, as well as other examples of NURBS meshes, can be found in <a href="https://github.com/mfem/mfem/tree/master/data">MFEM's data directory</a>. It can be visualized directly with</p>
<pre><code class="sh">glvis -m square-disc-nurbs.mesh
</code></pre>

<p>which after several refinements with the "<code>i</code>" key looks like</p>
<p><img alt="" src="../img/formats/glvis-square-disc-nurbs.png" /></p>
<p>To explain MFEM's NURBS mesh file format, we first note that the topological part of the mesh (the <code>elements</code> and <code>boundary</code> sections) describe the 4 NURBS patches visible above. We use the vertex numbers as labels, so we only need the number of vertices.</p>
<p>In the NURBS case we need to also provide description of the edges on the patch boundaries and associate a knot vector with each of them. This is done in the <code>edges</code> section where the first index in each row refers to the knot vector id (from the following <code>knotvectors</code> section), while the remaining two indexes are the edge vertex numbers.</p>
<p>The position of the NURBS nodes (control points) is given as a NURBS grid function at the end of the file, while the associated weights are listed in the preceding <code>weights</code> section.</p>
<p>Some examples of VTK meshes can be found in MFEM's <a href="https://github.com/mfem/mfem/blob/master/data">data directory</a>. Here is one of the 3D NURBS meshes</p>
<p><img alt="" src="../img/formats/glvis-pipe-nurbs.png" /></p>
<p>The image above was produced with some refinement (key "<code>o</code>") and mouse manipulations from</p>
<pre><code class="sh">glvis -m pipe-nurbs.mesh
</code></pre>

<p>Solutions from NURBS discretization spaces are also natively supported. For example here is the approximation for the solution of a simple Poisson problem on a refined version of the above mesh.</p>
<pre><code class="sh">glvis -m square-disc-nurbs.mesh -g sol.gf
</code></pre>

<p><img alt="" src="../img/formats/glvis-square-disc-nurbs-r2.png" /></p>
<h2 id="curvilinear-vtk-meshes">Curvilinear VTK meshes</h2>
<p>MFEM also supports quadratic triangular, quadrilaterals, tetrahedral and hexahedral curvilinear meshes in VTK format. This format is described in the <a href="http://vtk.org/VTK/img/file-formats.pdf">VTK file format documentation</a>. The local numbering of degrees of freedom for the biquadratic quads and triquadratic hexes can be found in the Doxygen reference of the <a href="http://www.vtk.org/doc/release/5.6/html/a00185.html">vtkBiQuadraticQuad</a> and <a href="http://www.vtk.org/doc/release/5.6/html/a02039.html">vtkTriQuadraticHexahedron</a> classes. Currently VTK does not support cubic, and higher-order meshes.</p>
<p>As an example, consider a simple curved quadrilateral saved in a file <code>quad.vtk</code>:</p>
<pre><code class="sh"># vtk DataFile Version 3.0
Generated by MFEM
ASCII
DATASET UNSTRUCTURED_GRID
POINTS 9 double
0 0 0
1 0 0
1 1 0
0.1 0.9 0
0.5 -0.05 0
0.9 0.5 0
0.5 1 0
0 0.5 0
0.45 0.55 0
CELLS 1 10
9 0 1 2 3 4 5 6 7 8
CELL_TYPES 1
28
CELL_DATA 1
SCALARS material int
LOOKUP_TABLE default
1
</code></pre>

<p>Visualizing it with "<code>glvis -m quad.vtk</code>" and typing "<code>Aemiii</code>" in the GLVis window we get:</p>
<p><img alt="" src="../img/formats/quad-vtk.png" /></p>
<p>The "<code>i</code>" key increases the reference element subdivision which gives an increasingly better approximation of the actual curvature of the element. To view the curvature of the mapping inside the element we can use the "I" key, e.g.,</p>
<pre><code class="sh">glvis -m quad.vtk -k &quot;AemIIiii&quot;
</code></pre>

<p><img alt="" src="../img/formats/quad-vtk-2.png" /></p>
<p>Here is a slightly more complicated <a href="https://github.com/mfem/mfem/blob/master/data/star-q2.vtk">quadratic quadrilateral</a> mesh example (the different colors in the GLVis window are used to distinguish neighboring elements):</p>
<pre><code class="sh">glvis -m star-q2.vtk -k &quot;Am&quot;
</code></pre>

<p><img alt="" src="../img/formats/star-q2-vtk.png" /></p>
<p>MFEM and GLVis can also handle <a href="https://github.com/mfem/mfem/blob/master/data/square-disc-p2.vtk">quadratic triangular</a> meshes:</p>
<pre><code class="sh">glvis -m square-disc-p2.vtk -k &quot;Am&quot;
</code></pre>

<p><img alt="" src="../img/formats/square-disc-p2-vtk.png" /></p>
<p>As well as <a href="https://github.com/mfem/mfem/blob/master/data/escher-p2.vtk">quadratic tetrahedral</a> and <a href="https://github.com/mfem/mfem/blob/master/data/fichera-q2.vtk">quadratic hexahedral</a> VTK meshes:</p>
<pre><code class="sh">glvis -m escher-p2.vtk -k &quot;Aaaooooo**************&quot;
</code></pre>

<p><img alt="" src="../img/formats/escher-p2-vtk.png" /></p>
<pre><code class="sh">glvis -m fichera-q2.vtk -k &quot;Aaaooooo******&quot;
</code></pre>

<p><img alt="" src="../img/formats/fichera-q2-vtk.png" /></p></div>
            <div class="col-md-3 hidden-xs hidden-sm"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#mesh-formats">Mesh Formats</a></li>
        
            <li><a href="#mfem-mesh-v10">MFEM mesh v1.0</a></li>
        
            <li><a href="#mfem-mesh-v11">MFEM mesh v1.1</a></li>
        
            <li><a href="#nurbs-meshes">NURBS meshes</a></li>
        
            <li><a href="#curvilinear-vtk-meshes">Curvilinear VTK meshes</a></li>
        
    
    </ul>
</div></div>

            
        </div>

        <footer class="footer">
           <div class="container">
              <p class="text-muted alignright">LLNL-WEB-676715</p>
              <p class="text-muted alignleft">
                  Developed by the <a href="/about/">MFEM team</a> at
                  <a href="http://computation.llnl.gov/casc/">CASC</a>,
                  <a href="https://www.llnl.gov/">LLNL</a></p>
           </div>
        </footer>

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script src="../js/base.js"></script>
        <script src="../js/retina.min.js"></script>
        <script src="../search/main.js"></script>
    </body>
</html>