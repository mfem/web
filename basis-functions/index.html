<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="/img/favicon.ico">
        <meta name="keywords" content="Finite Element Library,Finite Element Code,Finite Element Method Library,Finite Element Method Code,Finite Element C++,Finite Element Method C++,Finite Element Library C++,Finite Element Code C++,FEM Code,FEM Library,FEM C++">
        <meta name="google-site-verification" content="45K56TawSdzbgy-uDtfJdYwp7zaVdL3fIAGYt869wwU" />
<!--	<title></title>  -->
        <title>MFEM - Finite Element Discretization Library</title>

        <link href="../css/bootstrap-mfem.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../css/highlight.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

	<!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-NS5XV5TFM6"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-NS5XV5TFM6');
        </script>

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="https://mfem.org">MFEM</a>
        </div>

        <script>var base_url = '..';</script>
        <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
            
            
            
                <li >
                    <!-- Replace "nav_item.url|url" with "nav_item.url" for older mkdocs (before 1.0) -->
                    <a href="../features/">Features</a>
                </li>
            
            
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Examples <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                            <li >
                                 <a href="../examples/">Example Codes</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../electromagnetics/">Electromagnetics</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../fluids/">Fluid Dynamics</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../meshing-miniapps/">Meshing</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../nurbs/">NURBS Discretization</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../autodiff/">Automatic Differentiation</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../tools/">Tools</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../toys/">Toys</a>
                            </li>
                        
                    
                    </ul>
                </li>
            
            
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                            <li >
                                 <a href="../getting-started/">Getting Started</a>
                            </li>
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            <li >
                                 <a href="../howto/howto-index/">HowTo Articles</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../fem/">Finite Elements</a>
                            </li>
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            <li >
                                 <a href="../performance/">Performance</a>
                            </li>
                        
                    
                        
                    
                        
                            <li >
                                 <a href="../gpu-support/">GPU Support</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../mesh-formats/">Mesh Formats</a>
                            </li>
                        
                    
                        
                    
                        
                    
                        
                            <li >
                                 <a href="../dox/">Doxygen</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../publications/">Publications</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../about/">About</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../search/">ðŸ”Ž Search...</a>
                            </li>
                        
                    
                    </ul>
                </li>
            
            
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Community <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                            <li >
                                 <a href="../news/">News</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../videos/">Videos</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../seminar/">Seminar</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../workshop/">Workshop</a>
                            </li>
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            <li >
                                 <a href="../tutorial/">Tutorial</a>
                            </li>
                        
                    
                    </ul>
                </li>
            
            
            
            
            
                <li >
                    <!-- Replace "nav_item.url|url" with "nav_item.url" for older mkdocs (before 1.0) -->
                    <a href="../gallery/">Gallery</a>
                </li>
            
            
            
            
            
                <li >
                    <!-- Replace "nav_item.url|url" with "nav_item.url" for older mkdocs (before 1.0) -->
                    <a href="../download/">Download</a>
                </li>
            
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                
                <li>
                    <a href="https://github.com/mfem/mfem/">
                        
                            <i class="fa fa-github-square"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        
        <div class="container">
            
            <div class="col-md-3 visible-xs visible-sm"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#basis-functions">Basis Functions</a></li>
        
            <li><a href="#one-dimensional-polynomial-bases">One-Dimensional Polynomial Bases</a></li>
        
            <li><a href="#finite-element-collections-and-elements-of-different-types">Finite Element Collections and Elements of Different Types</a></li>
        
            <li><a href="#some-notes-on-choosing-basis-functions">Some Notes on Choosing Basis Functions</a></li>
        
    
    
	
	
	
           <hr style="background-color:white; height:20px; margin-left:-1px;  margin-right:-1px; margin-top:15px; margin-bottom:10px " />
           <li><a href="../fem/"><i class="fa fa-chevron-circle-left"></i> Back to Finite Element Method</a> </li>
        
	
    
    </ul>
</div>

<!-- Developer notes:
  See the MkDocs documentation in https://www.mkdocs.org/dev-guide/themes/#page
  and the Jinja2 template API in https://tedboy.github.io/jinja2/index.html
--></div> <!-- toc on top on mobile -->
            <div class="col-md-9" role="main">

<h1 id="basis-functions">Basis Functions</h1>
<p>The finite element method is based on the notion that a smooth function can be
approximated by a linear combination of piece-wise smooth functions (typically
piece-wise polynomials) called <em>basis functions</em>. The coefficients of the
linear combination are called <em>degrees of freedom (DoFs)</em> and are linear
functionals of the approximated function, e.g. values at interpolation points
or integrals over sub-manifolds of the domain. No matter the space the problem
is formulated in, H1, H(curl), H(div) or L2, or more precisely the discrete
space the problem is <a href="../fem_weak_form/">weakly-formulated</a> in, there is an
infinite range of possible bases spanning the very same discrete space.</p>
<h2 id="one-dimensional-polynomial-bases">One-Dimensional Polynomial Bases</h2>
<p>Consider the $[0,1]$ interval on the real line and the space of real,
univariate polynomials of degree less than or equal to $n$. Any set
${l_{j \in {0,...,n}}}$ of $n+1$ linearly independent polynomials of degree
less than or equal to $n$ forms a basis of this space. We say a basis
interpolates a given node $x$ if, for one of the basis functions $l_{j'}$ we
have $l_{j'}(x)=1$, and $l_{j \neq j'}(x)=0$. We distinguish between open and
closed bases. An <em>open</em> basis does <em>not</em> interpolate the interval endpoints,
whereas a <em>closed</em> basis does. If a basis is entirely interpolatory on a set of
nodes $x_{i \in {0,...,n}}$ in the sense that $l_j(x_i)=\delta_{ij}$, i.e. is a
Lagrange basis, we call it a <em>nodal</em> basis and all its associated DoFs
correspond to values of the approximated function.</p>
<p><center><strong>Cubic basis functions on [0,1]</strong></center>
<img alt="" src="../img/basis-functions.png" /></p>
<ul>
<li>
<p><code>GaussLegendre</code>: open and nodal basis; the basis of order $n$ interpolates
all the quadrature points of the Gauss-Legendre quadrature rule with $n+1$
points. These points are the zeros of the Legendre polynomial of degree $n+1$.</p>
</li>
<li>
<p><code>OpenUniform</code>: open and nodal basis; the basis of order $n$ interpolates all
the quadrature points of an open Newton-Cotes quadrature rule with $n+1$
equidistant points. These points partition the $[0,1]$ interval in $n+2$
subintervals of equal length, $x_{i \in {0,...,n}} = (i+1)/(n+2)$.</p>
</li>
<li>
<p><code>OpenHalfUniform</code>: open and nodal basis; the basis of order $n$ interpolates
all the quadrature points of an open Newton-Cotes quadrature rule with $n+1$
equidistant points. These are the midpoints of $n+1$ subintervals of equal
length partitioning the $[0,1]$ interval,
$x_{i \in {0,...,n}} = (1/2+i)/(n+1)$.</p>
</li>
<li>
<p><code>IntegratedGLL</code>: open basis; the basis of order $n$ histopolates all the
subintervals in-between the quadrature points of the Gauss-Lobatto quadrature
rule with $n+2$ points. These points are the $[0,1]$ interval endpoints plus
the zeros of the first derivative of the Legendre polynomial of degree $n+1$.
The integral of each basis function over its respective subinterval equals one
(or, alternatively, the length of the subinterval) and is zero over all other
$n$ subintervals, meaning that all DoFs associated with this basis correspond
to integrals (or, alternatively, mean values) of the approximated function over
the respective subinterval. See also <a href="https://doi.org/10.1007/978-3-642-15337-2_17">Gerritsma, M. (2011). Edge Functions for
Spectral Element Methods</a>.</p>
</li>
<li>
<p><code>GaussLobatto</code>: closed and nodal basis; the basis of order $n$ interpolates
all the quadrature points of the Gauss-Lobatto quadrature rule with $n+1$
points. These points are the $[0,1]$ interval endpoints plus the zeros of the
first derivative of the Legendre polynomial of degree $n$.</p>
</li>
<li>
<p><code>ClosedUniform</code>: closed and nodal basis; the basis of order $n$ interpolates
all the quadrature points of the closed Newton-Cotes quadrature rule with $n+1$
equidistant points. These points partition the $[0,1]$ interval in $n$
subintervals of equal length, $x_{i \in {0,...,n}} = i/n$.</p>
</li>
<li>
<p><code>ClosedGL</code>: closed and nodal basis; the basis of order $n$ interpolates the
$[0,1]$ interval endpoints plus the midpoints of the subintervals in-between
all the quadrature points of the Gauss-Legendre quadrature rule with $n$
points.</p>
</li>
<li>
<p><code>Positive</code>: closed basis; the basis of order $n$ is simply the Bernstein
polynomial basis of degree $n$ and only interpolates the $[0,1]$ interval
endpoints, $b_{i \in {0,...,n}}(x) = {n \choose i} x^{i}(1-x)^{n-i}$.</p>
</li>
</ul>
<p>The <a href="https://docs.mfem.org/html/classmfem_1_1Poly__1D_1_1Basis.html">Poly_1D::Basis</a> class includes member functions capable of
evaluating all of the aforementioned bases, as well as their first and second
derivatives, at an arbitrary point in the $[0,1]$ interval.
In addition, the enclosing <a href="https://docs.mfem.org/html/classmfem_1_1Poly__1D.html">Poly_1D</a> class includes facilities to
compute real, univariate polynomials forming hierarchical bases, including
monomials, Chebyshev, and Legendre polynomials.</p>
<h2 id="finite-element-collections-and-elements-of-different-types">Finite Element Collections and Elements of Different Types</h2>
<p>When constructing a <a href="https://docs.mfem.org/html/classmfem_1_1FiniteElementCollection.html">finite element collection</a> for
a given order and dimension, the user can often specify one, for
<a href="https://docs.mfem.org/html/classmfem_1_1H1__FECollection.html">H1</a> and <a href="https://docs.mfem.org/html/classmfem_1_1L2__FECollection.html">L2</a> spaces, or two, for
<a href="https://docs.mfem.org/html/classmfem_1_1ND__FECollection.html">ND</a> and <a href="https://docs.mfem.org/html/classmfem_1_1RT__FECollection.html">RT</a> spaces, of the one-dimensional
bases described above. In most cases the user can simply use the provided
defaults, Gauss-Lobatto for H1 spaces, Gauss-Lobatto plus Gauss-Legendre for
ND and RT spaces, and Gauss-Legendre for L2 spaces. This should not be confused
with the integration rule default, which remains Gauss-Legendre for all cases.</p>
<p>For tensor product elements, e.g. quadrilaterals or hexahedra, the basis
functions are just products of one-dimensional closed and/or open basis
functions. Alternatively, for order two and above, the smaller serendipity
basis, produces smaller system operators while converging at the same rate.
Note that support for serendipity hexahedral elements is still work in
progress and that for order one or in one dimension, the serendipity basis
degenerates into the Gauss-Lobatto basis described above.
For simplices, e.g. triangles or tetrahedra, the process of constructing the
basis functions is slightly more involved, but can essentially be pictured as
starting from the one-dimensional bases above and extending in a triangular
lattice on the faces and in the interior, thus retaining their property as
open, closed and/or nodal. In practice, in MFEM, the basis functions for
simplices are obtained as products of a hierarchical, one-dimensional basis of
Chebyshev polynomials of the first kind.
Triangular prisms and, more generally, wedge elements are the tensor product of
a triangle and segment element, while pyramids are based on <a href="https://doi.org/10.1016/j.camwa.2015.04.027">Fuentes, F. et al.
(2015). Orientation embedded high order shape functions for the exact sequence
elements of all shapes</a>.</p>
<p>The user can use the <a href="../tools/#display-basis"><code>display-basis</code> miniapp</a> to
visualize various types of basis functions on a single mesh element of their
choice.</p>
<h2 id="some-notes-on-choosing-basis-functions">Some Notes on Choosing Basis Functions</h2>
<p>Occasionally, the user might find the default basis functions are not suitable
for a given problem formulation. The following is a non-exhaustive list of
considerations to take into account when choosing what basis functions to use.</p>
<p>First, due to their nature, not all collections accept all function bases. For
instance, H1 spaces are continuous and thus require a basis which is
interpolatory at the element boundaries, i.e. a closed basis. On the contrary,
L2 spaces do not necessarily have DoFs at the element boundaries and can be
spanned by an open basis, or any basis in fact. If an open basis is selected
though, <a href="../fem_bc/#discontinuous-galerkin-formulations">extra care</a> is needed
in order to specify Dirichlet boundary conditions.</p>
<p>Next, nodal basis functions are particularly simple and efficient to evaluate
due to barycentric interpolation, and to integrate, especially if the user were
to write their own assembly routines using the corresponding collocated
quadrature rule.</p>
<p>Finally, Low-Order-Refined (LOR) discretizations are only spectrally equivalent
to the original high-order system if using a Gauss-Lobatto basis for H1 spaces
and Gauss-Lobatto plus IntegratedGLL bases for both ND and RT spaces. Note that
if a different choice is made, MFEM issues a warning but will still proceed.</p>
<script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: {equationNumbers: {autoNumber: "all"}}, tex2jax: {inlineMath: [['$','$']]}});</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_HTML"></script></div>
            <div class="col-md-3 hidden-xs hidden-sm"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#basis-functions">Basis Functions</a></li>
        
            <li><a href="#one-dimensional-polynomial-bases">One-Dimensional Polynomial Bases</a></li>
        
            <li><a href="#finite-element-collections-and-elements-of-different-types">Finite Element Collections and Elements of Different Types</a></li>
        
            <li><a href="#some-notes-on-choosing-basis-functions">Some Notes on Choosing Basis Functions</a></li>
        
    
    
	
	
	
           <hr style="background-color:white; height:20px; margin-left:-1px;  margin-right:-1px; margin-top:15px; margin-bottom:10px " />
           <li><a href="../fem/"><i class="fa fa-chevron-circle-left"></i> Back to Finite Element Method</a> </li>
        
	
    
    </ul>
</div>

<!-- Developer notes:
  See the MkDocs documentation in https://www.mkdocs.org/dev-guide/themes/#page
  and the Jinja2 template API in https://tedboy.github.io/jinja2/index.html
--></div>
            
        </div>
        

        <footer class="footer">
           <div class="container">
              <p class="text-muted alignright">LLNL-WEB-676715</p>
              <p class="text-muted alignleft">
                  Developed by the <a href="/about/">MFEM team</a> at
                  <a href="https://computing.llnl.gov/casc/">CASC</a>,
                  <a href="https://www.llnl.gov/">LLNL</a></p>
           </div>
        </footer>

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script src="../js/base.js"></script>
        <script src="../js/retina.min.js"></script>
        <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
        <script src="../search/main.js"></script>
    </body>
</html>