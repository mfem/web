<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="/img/favicon.ico">
        <meta name="keywords" content="Finite Element Library,Finite Element Code,Finite Element Method Library,Finite Element Method Code,Finite Element C++,Finite Element Method C++,Finite Element Library C++,Finite Element Code C++,FEM Code,FEM Library,FEM C++">
        <meta name="google-site-verification" content="45K56TawSdzbgy-uDtfJdYwp7zaVdL3fIAGYt869wwU" />
<!--	<title></title>  -->
        <title>MFEM - Finite Element Discretization Library</title>

        <link href="../css/bootstrap-mfem.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../css/highlight.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="http://mfem.org/">MFEM</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
            
            
            
                <li >
                    <!-- Replace "nav_item.url|url" with "nav_item.url" for older mkdocs (before 1.0) -->
                    <a href="../features/">Features</a>
                </li>
            
            
            
            
            
                <li >
                    <!-- Replace "nav_item.url|url" with "nav_item.url" for older mkdocs (before 1.0) -->
                    <a href="../examples/">Examples</a>
                </li>
            
            
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                    
                        
                            <li >
                                 <a href="../building/">Building MFEM</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../serial-tutorial/">Serial Tutorial</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../parallel-tutorial/">Parallel Tutorial</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../fem/">Finite Elements</a>
                            </li>
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            <li >
                                 <a href="../electromagnetics/">Electromagnetics</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../fluids/">Fluids</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../meshing/">Meshing</a>
                            </li>
                        
                    
                        
                    
                        
                    
                        
                            <li >
                                 <a href="../performance/">Performance</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../gpu-tips-n-tricks/">GPU Support</a>
                            </li>
                        
                    
                        
                    
                        
                    
                        
                            <li >
                                 <a href="../tools/">Tools</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../toys/">Toys</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../publications/">Publications</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../about/">About</a>
                            </li>
                        
                    
                    </ul>
                </li>
            
            
            
            
            
                <li >
                    <!-- Replace "nav_item.url|url" with "nav_item.url" for older mkdocs (before 1.0) -->
                    <a href="../gallery/">Gallery</a>
                </li>
            
            
            
            
            
                <li >
                    <!-- Replace "nav_item.url|url" with "nav_item.url" for older mkdocs (before 1.0) -->
                    <a href="../download/">Download</a>
                </li>
            
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                
                <li>
                    <a href="https://github.com/mfem/mfem/">
                        
                            <i class="fa fa-github-square"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
            <div class="col-md-3 visible-xs visible-sm"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#coefficients">Coefficients</a></li>
        
            <li><a href="#scalar-coefficients">Scalar Coefficients</a></li>
        
            <li><a href="#vector-coefficients">Vector Coefficients</a></li>
        
            <li><a href="#matrix-coefficients">Matrix Coefficients</a></li>
        
    
    </ul>
</div></div> <!-- toc on top on mobile -->
            <div class="col-md-9" role="main">

<h1 id="coefficients">Coefficients</h1>
<p>Coefficient objects serve many purposes within MFEM. As the name
suggests they often represent the material coefficients appearing in
partial differential equations. However, Coefficients can also be
used to specify initial conditions, boundary conditions, exact
solutions, etc..</p>
<p>Coefficients come in three varieties; scalar-valued, vector-valued,
and matrix-valued. The primary purpose of any Coefficient class is to
define an <code>Eval</code> method which returns a scalar, vector, or matrix
given an element and a location within that element expressed as a
point in reference space i.e. an <code>IntegrationPoint</code>. Coefficients can
also be time dependent. Time is treated as a parameter which changes
infrequently by passing the current time though a <code>SetTime(t)</code> method.</p>
<p>A Coefficient's <code>Eval</code> method depends on not only the position within
an element but also on the element attribute number which allows the
Coefficient to return different results from different regions of the
domain or boundary. This can be a powerful feature but it can lead to
unexpected results.  As a rule domain integrals will have access to
element attributes and boundary integrals will access the boundary
attributes.  This seems obvious but there may be cases where the
outcome is not so clear cut and careful thought is required.</p>
<p>It is important to know when a Coefficient will be accessed,
particularly in the case of time-dependent or field-dependent
coefficients.  When used with <code>GridFunction::Project</code>,
<code>GridFunction::ComputeL2Error</code>, and other <code>GridFunction</code> methods the
<code>Coefficient</code> is used immediately. When used in <code>BilinearForm</code> and
<code>LinearForm</code> objects the coefficients are only accessed during calls
to the <code>Assemble</code> methods.  An important side note is that
<code>GridFunction</code> and <code>LinearForm</code> objects will overwrite their values
during such calls but a <code>BilinearForm</code> will not.  Consequently, when
using a time-dependent coefficient with a <code>BilinearForm</code> object it is
crucial that the user calls <code>BilinearForm::Update</code> to reset the
internally stored matrix to zero before calling
<code>BilinearForm::Assemble</code>.  Otherwise the new matrix entries will be
added to the previous values leading to odd behavior.</p>
<h2 id="scalar-coefficients">Scalar Coefficients</h2>
<h3 id="basic-scalar-coefficients">Basic Scalar Coefficients</h3>
<table>
<thead>
<tr>
<th>Class Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ConstantCoefficient</td>
<td>Returns a constant value: $\alpha$</td>
</tr>
<tr>
<td>FunctionCoefficient</td>
<td>Computes a value from a standard function, $f(\vec{x},t)$, or a lambda expression</td>
</tr>
<tr>
<td>PWConstCoefficient</td>
<td>Returns different constants based e.g. on element attribute</td>
</tr>
<tr>
<td>GridFunctionCoefficient</td>
<td>Returns values interpolated from a scalar-valued <code>GridFunction</code>: $u(\vec{x})$</td>
</tr>
<tr>
<td>DivergenceGridFunctionCoefficient</td>
<td>Returns the divergence of a vector-valued  <code>GridFunction</code>:  $\nabla\cdot\vec{u}$</td>
</tr>
<tr>
<td>DeltaCoefficient</td>
<td>A weighted Dirac delta function: $s\,w(\vec{x},t)\,T(t)\,\delta(\vec{x}-\vec{x}_c)$</td>
</tr>
</tbody>
</table>
<h3 id="derived-scalar-coefficients">Derived Scalar Coefficients</h3>
<p>These classes provide a means of creating functions of existing
coefficients.  In performance critical situations it would clearly be
preferable to write specialized <code>Coefficient</code> classes but these offer
a quick and, hopefully, easy to use alternative.</p>
<table>
<thead>
<tr>
<th>Class Name</th>
<th>Formula</th>
</tr>
</thead>
<tbody>
<tr>
<td>TransformedCoefficient</td>
<td>$T(Q_1(\vec{x},t))\mbox{ or }T(Q_1(\vec{x},t),Q_2(\vec{x},t))$</td>
</tr>
<tr>
<td>RestrictedCoefficient</td>
<td>$Q(\vec{x})\,\forall a\in A, 0\mbox{ otherwise}$</td>
</tr>
<tr>
<td>SumCoefficient</td>
<td>$\alpha\,Q_1(\vec{x}) + \beta\,Q_2(\vec{x})$</td>
</tr>
<tr>
<td>ProductCoefficient</td>
<td>$Q_1(\vec{x})\,Q_2(\vec{x})$</td>
</tr>
<tr>
<td>PowerCoefficient</td>
<td>$Q(\vec{x})^p$</td>
</tr>
<tr>
<td>InnerProductCoefficient</td>
<td>$\vec{Q}_1\cdot\vec{Q}_2$</td>
</tr>
<tr>
<td>VectorRotProductCoefficient</td>
<td>$\vec{Q}_1\times\vec{Q}_2\mbox{ in }\mathbb{R}^2$</td>
</tr>
<tr>
<td>DeterminantCoefficient</td>
<td>$|\overleftrightarrow{Q}|$</td>
</tr>
</tbody>
</table>
<h2 id="vector-coefficients">Vector Coefficients</h2>
<h3 id="basic-vector-coefficients">Basic Vector Coefficients</h3>
<table>
<thead>
<tr>
<th>Class Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>VectorConstantCoefficient</td>
<td>Returns a constant vector value: $\vec{\alpha}$</td>
</tr>
<tr>
<td>VectorFunctionCoefficient</td>
<td>Computes a value from a standard function, $\vec{f}(\vec{x})$, or a lambda expression</td>
</tr>
<tr>
<td>VectorGridFunctionCoefficient</td>
<td>Returns values interpolated from a vector-valued <code>GridFunction</code>: $\vec{u}(\vec{x})$</td>
</tr>
<tr>
<td>GradientGridFunctionCoefficient</td>
<td>Returns the gradient of a scalar-valued  <code>GridFunction</code>:  $\nabla u(\vec{x})$</td>
</tr>
<tr>
<td>CurlGridFunctionCoefficient</td>
<td>Returns the curl of a vector-valued  <code>GridFunction</code>:  $\nabla\times\vec{u}(\vec{x})$</td>
</tr>
<tr>
<td>VectorDeltaCoefficient</td>
<td>$s\,\vec{\alpha}\,\delta(\vec{x}-\vec{x}_c)$</td>
</tr>
</tbody>
</table>
<h3 id="derived-vector-coefficients">Derived Vector Coefficients</h3>
<p>Again these classes provide a means of creating functions of existing
coefficients.</p>
<table>
<thead>
<tr>
<th>Class Name</th>
<th>Formula</th>
</tr>
</thead>
<tbody>
<tr>
<td>VectorArrayCoefficient</td>
<td>Construct a vector value from an array of scalar coefficients: $\vec{Q}_a$</td>
</tr>
<tr>
<td>VectorRestrictedCoefficient</td>
<td>$\vec{Q}(\vec{x})\,\forall a\in A, 0\mbox{ otherwise}$</td>
</tr>
<tr>
<td>VectorSumCoefficient</td>
<td>$\alpha\,\vec{Q}_1(\vec{x}) + \beta\,\vec{Q}_2(\vec{x})$</td>
</tr>
<tr>
<td>ScalarVectorProductCoefficient</td>
<td>$Q_1\,\vec{Q}_2$</td>
</tr>
<tr>
<td>VectorCrossProductCoefficient</td>
<td>$\vec{Q}_1\times\vec{Q}_2$</td>
</tr>
<tr>
<td>MatVecCoefficient</td>
<td>$\overleftrightarrow{Q}_1\cdot\vec{Q}_2$</td>
</tr>
</tbody>
</table>
<h2 id="matrix-coefficients">Matrix Coefficients</h2>
<h3 id="basic-matrix-coefficients">Basic Matrix Coefficients</h3>
<table>
<thead>
<tr>
<th>Class Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>MatrixConstantCoefficient</td>
<td>Returns a constant matrix value: $\overleftrightarrow{\alpha}$</td>
</tr>
<tr>
<td>MatrixFunctionCoefficient</td>
<td>Computes a value from a standard function, $\overleftrightarrow{f}$, or a lambda expression</td>
</tr>
<tr>
<td>IdentityMatrixCoefficient</td>
<td>Returns the identity matrix of the appropriate dimension: $\overleftrightarrow{I}$</td>
</tr>
</tbody>
</table>
<h3 id="derived-matrix-coefficients">Derived Matrix Coefficients</h3>
<p>Again these classes provide a means of creating functions of existing
coefficients.</p>
<table>
<thead>
<tr>
<th>Class Name</th>
<th>Formula</th>
</tr>
</thead>
<tbody>
<tr>
<td>MatrixArrayCoefficient</td>
<td>Construct a matrix value from an array of scalar coefficients: $\overleftrightarrow{Q}_a$</td>
</tr>
<tr>
<td>MatrixRestrictedCoefficient</td>
<td>$\overleftrightarrow{Q}(\vec{x})\,\forall a\in A, 0\mbox{ otherwise}$</td>
</tr>
<tr>
<td>MatrixSumCoefficient</td>
<td>$\alpha\,\overleftrightarrow{Q}_1(\vec{x}) + \beta\,\overleftrightarrow{Q}_2(\vec{x})$</td>
</tr>
<tr>
<td>ScalarMatrixProductCoefficient</td>
<td>$Q_1\,\overleftrightarrow{Q}_2$</td>
</tr>
<tr>
<td>TransposeMatrixCoefficient</td>
<td>$\overleftrightarrow{Q}^T$</td>
</tr>
<tr>
<td>InverseMatrixCoefficient</td>
<td>$\overleftrightarrow{Q}^{-1}$</td>
</tr>
<tr>
<td>OuterProductCoefficient</td>
<td>$\vec{Q}_1\otimes\vec{Q}_2$</td>
</tr>
</tbody>
</table>
<script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: {equationNumbers: {autoNumber: "all"}}, tex2jax: {inlineMath: [['$','$']]}});</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_HTML"></script></div>
            <div class="col-md-3 hidden-xs hidden-sm"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#coefficients">Coefficients</a></li>
        
            <li><a href="#scalar-coefficients">Scalar Coefficients</a></li>
        
            <li><a href="#vector-coefficients">Vector Coefficients</a></li>
        
            <li><a href="#matrix-coefficients">Matrix Coefficients</a></li>
        
    
    </ul>
</div></div>

            
        </div>

        <footer class="footer">
           <div class="container">
              <p class="text-muted alignright">LLNL-WEB-676715</p>
              <p class="text-muted alignleft">
                  Developed by the <a href="/about/">MFEM team</a> at
                  <a href="http://computation.llnl.gov/casc/">CASC</a>,
                  <a href="https://www.llnl.gov/">LLNL</a></p>
           </div>
        </footer>

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script src="../js/base.js"></script>
        <script src="../js/retina.min.js"></script>
        <script src="../search/main.js"></script>
    </body>
</html>